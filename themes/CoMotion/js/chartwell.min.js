// ********************************************************************************
//
//     FF Chartwell Web
//     Main module
//
//     (c) 2012 FontShop International, http://fontfont.com
//
//     Commercial product, may not be redistributed.
//
// ********************************************************************************

var defaultColor=new RGBColor("#000000");var defaultFontSize="12pt";var mainDivName="chartwell";var canvasDivName="chartwellcanvas";var debug=false;var runningID=0;var supportedChartTypes=Array();var possibleChartTypes=Array("barsvertical","bars","lines","pies","rose","rings","radar");var charts=Array();

// IE Compatibility
// Developed by Robert Nyman, http://www.robertnyman.com
// Code/licensing: http://code.google.com/p/getelementsbyclassname/
var getElementsByClassName=function(a,b,c){if(document.getElementsByClassName){getElementsByClassName=function(a,b,c){c=c||document;var d=c.getElementsByClassName(a),e=b?new RegExp("\\b"+b+"\\b","i"):null,f=[],g;for(var h=0,i=d.length;h<i;h+=1){g=d[h];if(!e||e.test(g.nodeName)){f.push(g)}}return f}}else if(document.evaluate){getElementsByClassName=function(a,b,c){b=b||"*";c=c||document;var d=a.split(" "),e="",f="http://www.w3.org/1999/xhtml",g=document.documentElement.namespaceURI===f?f:null,h=[],i,j;for(var k=0,l=d.length;k<l;k+=1){e+="[contains(concat(' ', @class, ' '), ' "+d[k]+" ')]"}try{i=document.evaluate(".//"+b+e,c,g,0,null)}catch(m){i=document.evaluate(".//"+b+e,c,null,0,null)}while(j=i.iterateNext()){h.push(j)}return h}}else{getElementsByClassName=function(a,b,c){b=b||"*";c=c||document;var d=a.split(" "),e=[],f=b==="*"&&c.all?c.all:c.getElementsByTagName(b),g,h=[],i;for(var j=0,k=d.length;j<k;j+=1){e.push(new RegExp("(^|\\s)"+d[j]+"(\\s|$)"))}for(var l=0,m=f.length;l<m;l+=1){g=f[l];i=false;for(var n=0,o=e.length;n<o;n+=1){i=e[n].test(g.className);if(!i){break}}if(i){h.push(g)}}return h}}return getElementsByClassName(a,b,c)};if(!window.getComputedStyle){window.getComputedStyle=function(a,b){this.el=a;this.getPropertyValue=function(b){var c=/(\-([a-z]){1})/g;if(b=="float")b="styleFloat";if(c.test(b)){b=b.replace(c,function(){return arguments[2].toUpperCase()})}return a.currentStyle[b]?a.currentStyle[b]:null};return this}}function customGetComputedStyle(item,property){var returnValue;if(oldIE()){var compStyle=window.getComputedStyle(item,"");returnValue=compStyle.getPropertyValue(property)}else{eval("returnValue = window.getComputedStyle(item, null)."+property+";")}return returnValue}function getInternetExplorerVersion(){var a=-1;if(navigator.appName=="Microsoft Internet Explorer"){var b=navigator.userAgent;var c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(c.exec(b)!=null)a=parseFloat(RegExp.$1)}return a}function oldIE(){var a=false;var b=getInternetExplorerVersion();if(b>-1){if(b>=8)a=false;else a=true}return a}

//A class to parse color values
// @author Stoyan Stefanov <sstoo@gmail.com>
// @link   http://www.phpied.com/rgb-color-parser-in-javascript/
// @license Use it if you like it
//

function RGBColor(a){this.ok=false;if(a.charAt(0)=="#"){a=a.substr(1,6)}a=a.replace(/ /g,"");a=a.toLowerCase();var b={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var c in b){if(a==c){a=b[c]}}var d=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}];for(var e=0;e<d.length;e++){var f=d[e].re;var g=d[e].process;var h=f.exec(a);if(h){channels=g(h);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r;this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g;this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b;this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toHex=function(){var a=this.r.toString(16);var b=this.g.toString(16);var c=this.b.toString(16);if(a.length==1)a="0"+a;if(b.length==1)b="0"+b;if(c.length==1)c="0"+c;return"#"+a+b+c};this.getHelpXML=function(){var a=new Array;for(var c=0;c<d.length;c++){var e=d[c].example;for(var f=0;f<e.length;f++){a[a.length]=e[f]}}for(var g in b){a[a.length]=g}var h=document.createElement("ul");h.setAttribute("id","rgbcolor-examples");for(var c=0;c<a.length;c++){try{var i=document.createElement("li");var j=new RGBColor(a[c]);var k=document.createElement("div");k.style.cssText="margin: 3px; "+"border: 1px solid black; "+"background:"+j.toHex()+"; "+"color:"+j.toHex();k.appendChild(document.createTextNode("test"));var l=document.createTextNode(" "+a[c]+" -> "+j.toRGB()+" -> "+j.toHex());i.appendChild(k);i.appendChild(l);h.appendChild(i)}catch(m){}}return h}}

// FF Chartwell Web main module
// (c) 2012 FontShop International
function Chart(div){function NoJS(a){warning('Error: No JavaScript module available for "'+a.className+'". Make sure the file "'+a.className.replace(" ","_")+'.js" is loaded.')}this.inScale=function(a){return a*this.drawingScale};this.inScaleY=function(a){return this.chartHeight()-a*this.drawingScale};this.inScaleOffset=function(a){return(a+this.xoffset)*this.drawingScale};this.sum=function(){var a=0;for(var b=0;b<this.values.length;b++){if(this.values[b]=="value"){a+=this.values[b].value}}return a};this.amountOfValues=function(){var a=0;for(var b=0;b<this.values.length;b++){if(this.values[b].type=="value"){a+=1}}return a};this.div=div;this.ID="chartwellcanvas"+getID();this.xoffset=0;this.text=elementText(this.div).replace(/\s/g,"");if(calcFontSizeInPt(customGetComputedStyle(this.div,"fontSize"))){this.fontSize=calcFontSizeInPt(customGetComputedStyle(this.div,"fontSize"))}else{this.fontSize=calcFontSizeInPt(defaultFontSize)}this.drawingScale=this.fontSize/1e3*96/72;this.chartWidth=function(){NoJS(this.div)};this.chartHeight=function(){NoJS(this.div)};this.draw=function(){NoJS(this.div)};this.normalizeValue=function(){NoJS(this.div)};this.valueType=function(){NoJS(this.div)};for(c=0;c<possibleChartTypes.length;c++){chartType=possibleChartTypes[c];if(!this.type&&this.div.className.has(chartType)&&supportedChartTypes.has(chartType)){this.type=chartType;eval("this.chartWidth = this."+chartType+"_chartWidth;");eval("this.chartHeight = this."+chartType+"_chartHeight;");eval("this.draw = this."+chartType+"_draw;");eval("this.normalizeValue = this."+chartType+"_normalizeValue;");eval("this.valueType = this."+chartType+"_valueType;")}}this.values=Array();var spans=this.div.getElementsByTagName("span");for(var i=0;i<spans.length;i++){this.values.push(new Value(this,spans[i]))}this.div.innerHTML='<canvas class="'+canvasDivName+'" id="'+this.ID+'"></canvas>';this.canvas=document.getElementById(this.ID);this.canvas.width=this.chartWidth();this.canvas.height=this.chartHeight();if(oldIE()){G_vmlCanvasManager.initElement(this.canvas)}this.canvasContext=this.canvas.getContext("2d");return true}function Value(a,b){this.parent=a;this.span=b;this.value=this.parent.normalizeValue(elementText(this.span).replace(/\s/g,""));this.type=this.parent.valueType(this.value);this.color=new RGBColor(customGetComputedStyle(this.span,"color"));return true}
function getID(){runningID=runningID+1;return runningID}function log(a){if(debug){if(oldIE()){alert(a)}else{if(window.console){console.log(a)}}}}
function warning(a){if(oldIE()){alert(a)}else{if(window.console){console.log(a)}}}function ord(a){return a.charCodeAt(0)}function Interpolate(a,b,c){return a+(b-a)*c}function calcFontSizeInPt(a){var b=false;if(a.endsWith("pt")){b=parseInt(a.substr(0,a.length-2).replace(/\s/g,""))}else if(a.endsWith("px")){b=parseInt(a.substr(0,a.length-2).replace(/\s/g,""))*72/96}return b}function elementText(a){var b=a.innerText||a.textContent;return b}function FFChartwell(){var a=getElementsByClassName(mainDivName);for(var b=0;b<a.length;b++){charts.push(new Chart(a[b]))}for(var b=0;b<charts.length;b++){chart=charts[b];chart.draw()}}function radians(a){return a*(Math.PI/180)}function RotatePointAroundPoint(a,b,c){p2=Array(NaN,NaN);p2[0]=Math.cos(radians(c))*(b[0]-a[0])-Math.sin(radians(c))*(b[1]-a[1])+a[0];p2[1]=Math.sin(radians(c))*(b[0]-a[0])+Math.cos(radians(c))*(b[1]-a[1])+a[1];return p2}
Array.prototype.index=function(a){for(var b=0;b<this.length;b++){if(this[b]==a)return b}};Array.prototype.has=function(a){for(var b=0;b<this.length;b++){if(this[b]==a)return true}};String.prototype.endsWith=function(a){if(this.substr(this.length-a.length,a.length)==a){return true}};String.prototype.has=function(a){if(this.indexOf(a)>=0){return true}}