// ********************************************************************************
//
//     FF Chartwell Web
//     Pies module
//
//     (c) 2012 FontShop International, http://fontfont.com
//
//     Commercial product, may not be redistributed.
//
// ********************************************************************************


var piesCounterWidth=813;var piesDiameter=713;var piesValueHeight=10;var piesMargin=10;supportedChartTypes.push("pies");log("Pies module loaded.");Chart.prototype.pies_normalizeValue=function(a){if(parseInt(a)||a==0){if(a<0){a=0}else if(a>100){a=100}}return a};Chart.prototype.pies_valueType=function(a){if(parseInt(a)){return"value"}else{return"centerpiece"}};Chart.prototype.pies_chartWidth=function(){return Math.ceil(this.inScale(piesCounterWidth+2*piesMargin))};Chart.prototype.pies_chartHeight=function(){return Math.ceil(this.inScale(piesDiameter+2*piesMargin))};Chart.prototype.pies_draw=function(){log("Drawing canvas *"+this.ID+"* of type *"+this.type+"*");var a=-.5;var b=Array(piesCounterWidth/2+piesMargin,piesDiameter/2+piesMargin);var c=0;if(this.values[this.values.length-1].type=="centerpiece"){var d=this.values[this.values.length-1].value;c=ord(d);if(c>=97){c-=97}else if(c<=90){c-=39}c/=51}for(var e=0;e<this.values.length;e++){value=this.values[e];if(value.type=="value"){this.canvasContext.beginPath();this.canvasContext.moveTo(this.inScale(b[0]),this.inScaleY(b[1]));var f=piesDiameter/2;var g=a*Math.PI;var h=value.value/100*2;var i=(a+h)*Math.PI;var j=false;this.canvasContext.arc(this.inScale(b[0]),this.inScaleY(b[1]),this.inScale(f),g,i,j);this.canvasContext.closePath();this.canvasContext.fillStyle=value.color.toHex();this.canvasContext.fill();a+=h}else if(value.type=="centerpiece"){var f=Interpolate(45/2,701/2,c);this.canvasContext.beginPath();this.canvasContext.arc(this.inScale(b[0]),this.inScaleY(b[1]),this.inScale(f),0,2*Math.PI,false);this.canvasContext.closePath();this.canvasContext.fillStyle=value.color.toHex();this.canvasContext.fill()}}}